#!/usr/bin/env bats

setup() {
  if $(terrascan -h); then
    echo "Terrascan installed"
  elif $(ls bin/terrascan); then
    mv bin/terrascan /usr/local/bin
  else
    make build
    mv bin/terrascan /usr/local/bin
  fi
}

@test "terrascan" {
  # This runs Terrascan with a JSON output
  run terrascan scan -t aws \
    -p pkg/policies/opa/rego \
    -d tests/test_templates \
    -o json

  # Checks that all policies are captured in the output
  [[ "$output" == *"AWS.ALB.NetworkPortsSecurity.High.0194"* ]]
  [[ "$output" == *"AWS.ALB.NetworkPortsSecurity.High.0196"* ]]
  [[ "$output" == *"AWS.ALB.NetworkPortsSecurity.High.0218"* ]]
  [[ "$output" == *"AWS.ALB.NetworkPortsSecurity.High.0220"* ]]
  [[ "$output" == *"AWS.ALB.NetworkPortsSecurity.High.0222"* ]]
  [[ "$output" == *"AWS.ALB.NetworkPortsSecurity.High.0224"* ]]
  [[ "$output" == *"AWS.ALB.NetworkPortsSecurity.High.0226"* ]]
  [[ "$output" == *"AWS.ALB.NetworkPortsSecurity.High.0228"* ]]
  [[ "$output" == *"AWS.ALB.NetworkPortsSecurity.High.0230"* ]]
  [[ "$output" == *"AWS.ALB.NetworkPortsSecurity.High.0232"* ]]
  [[ "$output" == *"AWS.ALB.NetworkPortsSecurity.High.0234"* ]]
  [[ "$output" == *"AWS.ALB.NetworkPortsSecurity.High.0236"* ]]
  [[ "$output" == *"AWS.ALB.NetworkPortsSecurity.High.0238"* ]]
  [[ "$output" == *"AWS.ALB.NetworkPortsSecurity.High.0240"* ]]
  [[ "$output" == *"AWS.ALB.NetworkPortsSecurity.High.0242"* ]]
  [[ "$output" == *"AWS.ALB.NetworkPortsSecurity.High.0244"* ]]
  [[ "$output" == *"AWS.ALB.NetworkPortsSecurity.High.0246"* ]]
  [[ "$output" == *"AWS.ALB.NetworkPortsSecurity.High.0248"* ]]
  [[ "$output" == *"AWS.ALB.NetworkPortsSecurity.High.0250"* ]]
  [[ "$output" == *"AWS.ALB.NetworkPortsSecurity.High.0252"* ]]
  [[ "$output" == *"AWS.ALB.NetworkPortsSecurity.High.0254"* ]]
  [[ "$output" == *"AWS.ALB.NetworkPortsSecurity.High.0256"* ]]
  [[ "$output" == *"AWS.ALB.NetworkPortsSecurity.High.0258"* ]]
  [[ "$output" == *"AWS.ALB.NetworkPortsSecurity.High.0260"* ]]
  [[ "$output" == *"AWS.ALB.NetworkPortsSecurity.High.0262"* ]]
  [[ "$output" == *"AWS.ALB.NetworkPortsSecurity.High.0264"* ]]
  [[ "$output" == *"AWS.ALB.NetworkPortsSecurity.High.0266"* ]]
  [[ "$output" == *"AWS.ALB.NetworkPortsSecurity.High.0268"* ]]
  [[ "$output" == *"AWS.ALB.NetworkPortsSecurity.High.0270"* ]]
  [[ "$output" == *"AWS.ALB.NetworkPortsSecurity.High.0272"* ]]
  [[ "$output" == *"AWS.ALB.NetworkPortsSecurity.High.0274"* ]]
  [[ "$output" == *"AWS.ALB.NetworkPortsSecurity.High.0276"* ]]
  [[ "$output" == *"AWS.ALB.NetworkPortsSecurity.High.0278"* ]]
  [[ "$output" == *"AWS.ALB.NetworkPortsSecurity.High.0280"* ]]
  [[ "$output" == *"AWS.AWS RDS.NS.High.0101"* ]]
  [[ "$output" == *"AWS.CloudFront.EncryptionandKeyManagement.High.0407"* ]]
  [[ "$output" == *"AWS.CloudFront.EncryptionandKeyManagement.High.0407"* ]]
  [[ "$output" == *"AWS.CloudFront.EncryptionandKeyManagement.High.0408"* ]]
  [[ "$output" == *"AWS.CloudFront.Logging.Medium.0567"* ]]
  [[ "$output" == *"AWS.CloudFront.Network Security.Low.0568"* ]]
  [[ "$output" == *"AWS.CloudTrail.Logging.Medium.0460"* ]]
  [[ "$output" == *"AWS.EcsCluster.EncryptionandKeyManagement.High.0413"* ]]
  [[ "$output" == *"AWS.Iam.IAM.Low.0539"* ]]
  [[ "$output" == *"AWS.Iam.IAM.Low.0540"* ]]
  [[ "$output" == *"AWS.Iam.IAM.Medium.0454"* ]]
  [[ "$output" == *"AWS.Iam.IAM.Medium.0455"* ]]
  [[ "$output" == *"AWS.Iam.IAM.Medium.0456"* ]]
  [[ "$output" == *"AWS.Iam.IAM.Medium.0457"* ]]
  [[ "$output" == *"AWS.Iam.IAM.Medium.0458"* ]]
  [[ "$output" == *"AWS.Iam.IAM.Medium.0458"* ]]
  [[ "$output" == *"AWS.Iam.IAM.Medium.0495"* ]]
  [[ "$output" == *"AWS.IamPolicy.IAM.High.0373"* ]]
  [[ "$output" == *"AWS.IamPolicy.IAM.High.0373"* ]]
  [[ "$output" == *"AWS.IamPolicy.IAM.High.0374"* ]]
  [[ "$output" == *"AWS.IamPolicy.IAM.High.0375"* ]]
  [[ "$output" == *"AWS.IamPolicy.IAM.High.0375"* ]]
  [[ "$output" == *"AWS.IamPolicy.IAM.High.0376"* ]]
  [[ "$output" == *"AWS.IamPolicy.IAM.High.0392"* ]]
  [[ "$output" == *"AWS.IamUser.IAM.High.0387"* ]]
  [[ "$output" == *"AWS.IamUser.IAM.High.0387"* ]]
  [[ "$output" == *"AWS.IamUser.IAM.High.0387"* ]]
  [[ "$output" == *"AWS.IamUser.IAM.High.0388"* ]]
  [[ "$output" == *"AWS.IamUser.IAM.High.0388"* ]]
  [[ "$output" == *"AWS.IamUser.IAM.High.0388"* ]]
  [[ "$output" == *"AWS.IamUser.IAM.High.0389"* ]]
  [[ "$output" == *"AWS.IamUser.IAM.High.0390"* ]]
  [[ "$output" == *"AWS.IamUser.IAM.High.0391"* ]]
  [[ "$output" == *"AWS.Instance.NetworkSecurity.Medium.0506"* ]]
  [[ "$output" == *"AWS.KMS.NetworkSecurity.High.0566"* ]]
  [[ "$output" == *"AWS.LaunchConfiguration.DataSecurity.High.0101"* ]]
  [[ "$output" == *"AWS.LaunchConfiguration.DataSecurity.High.0102"* ]]
  [[ "$output" == *"AWS.RDS.DS.High.1041"* ]]
  [[ "$output" == *"AWS.RDS.DS.High.1042"* ]]
  [[ "$output" == *"AWS.RDS.DataSecurity.High.0414"* ]]
  [[ "$output" == *"AWS.RDS.DataSecurity.High.0414"* ]]
  [[ "$output" == *"AWS.RDS.DataSecurity.High.0414"* ]]
  [[ "$output" == *"AWS.RDS.DataSecurity.High.0414"* ]]
  [[ "$output" == *"AWS.RDS.DataSecurity.High.0577"* ]]
  [[ "$output" == *"AWS.RDS.DataSecurity.High.0577"* ]]
  [[ "$output" == *"AWS.RDS.DataSecurity.High.0577"* ]]
  [[ "$output" == *"AWS.RDS.DataSecurity.High.0577"* ]]
  [[ "$output" == *"AWS.S3Bucket.DS.High.1043"* ]]
  [[ "$output" == *"AWS.S3Bucket.DS.High.1043"* ]]
  [[ "$output" == *"AWS.S3Bucket.DS.High.1043"* ]]
  [[ "$output" == *"AWS.S3Bucket.DS.High.1043"* ]]
  [[ "$output" == *"AWS.S3Bucket.DS.High.1043"* ]]
  [[ "$output" == *"AWS.S3Bucket.DS.High.1043"* ]]
  [[ "$output" == *"AWS.S3Bucket.DS.High.1043"* ]]
  [[ "$output" == *"AWS.S3Bucket.DS.High.1043"* ]]
  [[ "$output" == *"AWS.S3Bucket.DS.High.1043"* ]]
  [[ "$output" == *"AWS.S3Bucket.DS.High.1043"* ]]
  [[ "$output" == *"AWS.S3Bucket.IAM.High.0370"* ]]
  [[ "$output" == *"AWS.S3Bucket.IAM.High.0370"* ]]
  [[ "$output" == *"AWS.S3Bucket.IAM.High.0370"* ]]
  [[ "$output" == *"AWS.S3Bucket.IAM.High.0370"* ]]
  [[ "$output" == *"AWS.S3Bucket.IAM.High.0370"* ]]
  [[ "$output" == *"AWS.S3Bucket.IAM.High.0370"* ]]
  [[ "$output" == *"AWS.S3Bucket.IAM.High.0370"* ]]
  [[ "$output" == *"AWS.S3Bucket.IAM.High.0370"* ]]
  [[ "$output" == *"AWS.S3Bucket.IAM.High.0371"* ]]
  [[ "$output" == *"AWS.S3Bucket.IAM.High.0372"* ]]
  [[ "$output" == *"AWS.S3Bucket.IAM.High.0377"* ]]
  [[ "$output" == *"AWS.S3Bucket.IAM.High.0377"* ]]
  [[ "$output" == *"AWS.S3Bucket.IAM.High.0378"* ]]
  [[ "$output" == *"AWS.S3Bucket.IAM.High.0379"* ]]
  [[ "$output" == *"AWS.S3Bucket.IAM.High.0379"* ]]
  [[ "$output" == *"AWS.S3Bucket.IAM.High.0381"* ]]
  [[ "$output" == *"AWS.S3Bucket.IAM.High.0381"* ]]
  [[ "$output" == *"AWS.S3Bucket.NetworkSecurity.High.0417"* ]]
  [[ "$output" == *"AWS.SecurityGroup.NPS.High.1045"* ]]
  [[ "$output" == *"AWS.SecurityGroup.NPS.High.1045"* ]]
  [[ "$output" == *"AWS.SecurityGroup.NPS.High.1046"* ]]
  [[ "$output" == *"AWS.SecurityGroup.NPS.High.1046"* ]]
  [[ "$output" == *"AWS.SecurityGroup.NPS.High.1046"* ]]
  [[ "$output" == *"AWS.SecurityGroup.NPS.High.1046"* ]]
  [[ "$output" == *"AWS.SecurityGroup.NPS.High.1046"* ]]
  [[ "$output" == *"AWS.SecurityGroup.NPS.High.1046"* ]]
  [[ "$output" == *"AWS.SecurityGroup.NPS.High.1046"* ]]
  [[ "$output" == *"AWS.SecurityGroup.NPS.High.1046"* ]]
  [[ "$output" == *"AWS.SecurityGroup.NPS.High.1046"* ]]
  [[ "$output" == *"AWS.SecurityGroup.NPS.High.1046"* ]]
  [[ "$output" == *"AWS.SecurityGroup.NPS.High.1046"* ]]
  [[ "$output" == *"AWS.SecurityGroup.NPS.High.1046"* ]]
  [[ "$output" == *"AWS.SecurityGroup.NPS.High.1046"* ]]
  [[ "$output" == *"AWS.SecurityGroup.NPS.High.1046"* ]]
  [[ "$output" == *"AWS.SecurityGroup.NPS.High.1046"* ]]
  [[ "$output" == *"AWS.SecurityGroup.NPS.High.1046"* ]]
  [[ "$output" == *"AWS.SecurityGroup.NPS.High.1046"* ]]
  [[ "$output" == *"AWS.SecurityGroup.NetworkPortsSecurity.Low.0560"* ]]
  [[ "$output" == *"AWS.SecurityGroup.NetworkPortsSecurity.Low.0561"* ]]
  [[ "$output" == *"AWS.SecurityGroup.NetworkPortsSecurity.Low.0562"* ]]
  [[ "$output" == *"AWS.SecurityGroup.NetworkSecurity.High.0094"* ]]
  [[ "$output" == *"AWS.VPC.Logging.Medium.0470"* ]]
  [[ "$output" == *"accurics.azure.BDR.163"* ]]
  [[ "$output" == *"accurics.azure.EKM.1"* ]]
  [[ "$output" == *"accurics.azure.EKM.1"* ]]
  [[ "$output" == *"accurics.azure.EKM.156"* ]]
  [[ "$output" == *"accurics.azure.EKM.23"* ]]
  [[ "$output" == *"accurics.azure.IAM.10"* ]]
  [[ "$output" == *"accurics.azure.IAM.10"* ]]
  [[ "$output" == *"accurics.azure.IAM.10"* ]]
  [[ "$output" == *"accurics.azure.IAM.10"* ]]
  [[ "$output" == *"accurics.azure.IAM.138"* ]]
  [[ "$output" == *"accurics.azure.LOG.151"* ]]
  [[ "$output" == *"accurics.azure.LOG.152"* ]]
  [[ "$output" == *"accurics.azure.LOG.153"* ]]
  [[ "$output" == *"accurics.azure.LOG.154"* ]]
  [[ "$output" == *"accurics.azure.LOG.155"* ]]
  [[ "$output" == *"accurics.azure.MON.157"* ]]
  [[ "$output" == *"accurics.azure.NPS.100"* ]]
  [[ "$output" == *"accurics.azure.NPS.101"* ]]
  [[ "$output" == *"accurics.azure.NPS.102"* ]]
  [[ "$output" == *"accurics.azure.NPS.103"* ]]
  [[ "$output" == *"accurics.azure.NPS.104"* ]]
  [[ "$output" == *"accurics.azure.NPS.105"* ]]
  [[ "$output" == *"accurics.azure.NPS.106"* ]]
  [[ "$output" == *"accurics.azure.NPS.107"* ]]
  [[ "$output" == *"accurics.azure.NPS.108"* ]]
  [[ "$output" == *"accurics.azure.NPS.109"* ]]
  [[ "$output" == *"accurics.azure.NPS.110"* ]]
  [[ "$output" == *"accurics.azure.NPS.111"* ]]
  [[ "$output" == *"accurics.azure.NPS.112"* ]]
  [[ "$output" == *"accurics.azure.NPS.113"* ]]
  [[ "$output" == *"accurics.azure.NPS.114"* ]]
  [[ "$output" == *"accurics.azure.NPS.115"* ]]
  [[ "$output" == *"accurics.azure.NPS.116"* ]]
  [[ "$output" == *"accurics.azure.NPS.117"* ]]
  [[ "$output" == *"accurics.azure.NPS.118"* ]]
  [[ "$output" == *"accurics.azure.NPS.119"* ]]
  [[ "$output" == *"accurics.azure.NPS.170"* ]]
  [[ "$output" == *"accurics.azure.NPS.171"* ]]
  [[ "$output" == *"accurics.azure.NPS.172"* ]]
  [[ "$output" == *"accurics.azure.NPS.173"* ]]
  [[ "$output" == *"accurics.azure.NPS.174"* ]]
  [[ "$output" == *"accurics.azure.NPS.175"* ]]
  [[ "$output" == *"accurics.azure.NPS.176"* ]]
  [[ "$output" == *"accurics.azure.NPS.177"* ]]
  [[ "$output" == *"accurics.azure.NPS.178"* ]]
  [[ "$output" == *"accurics.azure.NPS.179"* ]]
  [[ "$output" == *"accurics.azure.NPS.180"* ]]
  [[ "$output" == *"accurics.azure.NPS.181"* ]]
  [[ "$output" == *"accurics.azure.NPS.182"* ]]
  [[ "$output" == *"accurics.azure.NPS.183"* ]]
  [[ "$output" == *"accurics.azure.NPS.184"* ]]
  [[ "$output" == *"accurics.azure.NPS.185"* ]]
  [[ "$output" == *"accurics.azure.NPS.186"* ]]
  [[ "$output" == *"accurics.azure.NPS.187"* ]]
  [[ "$output" == *"accurics.azure.NPS.188"* ]]
  [[ "$output" == *"accurics.azure.NPS.189"* ]]
  [[ "$output" == *"accurics.azure.NPS.190"* ]]
  [[ "$output" == *"accurics.azure.NPS.191"* ]]
  [[ "$output" == *"accurics.azure.NPS.192"* ]]
  [[ "$output" == *"accurics.azure.NPS.193"* ]]
  [[ "$output" == *"accurics.azure.NPS.194"* ]]
  [[ "$output" == *"accurics.azure.NPS.195"* ]]
  [[ "$output" == *"accurics.azure.NPS.196"* ]]
  [[ "$output" == *"accurics.azure.NPS.197"* ]]
  [[ "$output" == *"accurics.azure.NPS.198"* ]]
  [[ "$output" == *"accurics.azure.NPS.199"* ]]
  [[ "$output" == *"accurics.azure.NPS.200"* ]]
  [[ "$output" == *"accurics.azure.NPS.201"* ]]
  [[ "$output" == *"accurics.azure.NPS.202"* ]]
  [[ "$output" == *"accurics.azure.NPS.203"* ]]
  [[ "$output" == *"accurics.azure.NPS.204"* ]]
  [[ "$output" == *"accurics.azure.NPS.205"* ]]
  [[ "$output" == *"accurics.azure.NPS.206"* ]]
  [[ "$output" == *"accurics.azure.NPS.207"* ]]
  [[ "$output" == *"accurics.azure.NPS.208"* ]]
  [[ "$output" == *"accurics.azure.NPS.209"* ]]
  [[ "$output" == *"accurics.azure.NPS.210"* ]]
  [[ "$output" == *"accurics.azure.NPS.211"* ]]
  [[ "$output" == *"accurics.azure.NPS.212"* ]]
  [[ "$output" == *"accurics.azure.NPS.213"* ]]
  [[ "$output" == *"accurics.azure.NPS.214"* ]]
  [[ "$output" == *"accurics.azure.NPS.215"* ]]
  [[ "$output" == *"accurics.azure.NPS.216"* ]]
  [[ "$output" == *"accurics.azure.NPS.217"* ]]
  [[ "$output" == *"accurics.azure.NPS.218"* ]]
  [[ "$output" == *"accurics.azure.NPS.219"* ]]
  [[ "$output" == *"accurics.azure.NPS.220"* ]]
  [[ "$output" == *"accurics.azure.NPS.221"* ]]
  [[ "$output" == *"accurics.azure.NPS.222"* ]]
  [[ "$output" == *"accurics.azure.NPS.223"* ]]
  [[ "$output" == *"accurics.azure.NPS.224"* ]]
  [[ "$output" == *"accurics.azure.NPS.225"* ]]
  [[ "$output" == *"accurics.azure.NPS.226"* ]]
  [[ "$output" == *"accurics.azure.NPS.227"* ]]
  [[ "$output" == *"accurics.azure.NPS.228"* ]]
  [[ "$output" == *"accurics.azure.NPS.229"* ]]
  [[ "$output" == *"accurics.azure.NPS.230"* ]]
  [[ "$output" == *"accurics.azure.NPS.231"* ]]
  [[ "$output" == *"accurics.azure.NPS.232"* ]]
  [[ "$output" == *"accurics.azure.NPS.233"* ]]
  [[ "$output" == *"accurics.azure.NPS.234"* ]]
  [[ "$output" == *"accurics.azure.NPS.235"* ]]
  [[ "$output" == *"accurics.azure.NPS.236"* ]]
  [[ "$output" == *"accurics.azure.NPS.237"* ]]
  [[ "$output" == *"accurics.azure.NPS.238"* ]]
  [[ "$output" == *"accurics.azure.NPS.239"* ]]
  [[ "$output" == *"accurics.azure.NPS.240"* ]]
  [[ "$output" == *"accurics.azure.NPS.241"* ]]
  [[ "$output" == *"accurics.azure.NPS.242"* ]]
  [[ "$output" == *"accurics.azure.NPS.243"* ]]
  [[ "$output" == *"accurics.azure.NPS.244"* ]]
  [[ "$output" == *"accurics.azure.NPS.245"* ]]
  [[ "$output" == *"accurics.azure.NPS.246"* ]]
  [[ "$output" == *"accurics.azure.NPS.247"* ]]
  [[ "$output" == *"accurics.azure.NPS.248"* ]]
  [[ "$output" == *"accurics.azure.NPS.249"* ]]
  [[ "$output" == *"accurics.azure.NPS.250"* ]]
  [[ "$output" == *"accurics.azure.NPS.251"* ]]
  [[ "$output" == *"accurics.azure.NPS.252"* ]]
  [[ "$output" == *"accurics.azure.NPS.253"* ]]
  [[ "$output" == *"accurics.azure.NPS.254"* ]]
  [[ "$output" == *"accurics.azure.NPS.275"* ]]
  [[ "$output" == *"accurics.azure.NPS.276"* ]]
  [[ "$output" == *"accurics.azure.NPS.277"* ]]
  [[ "$output" == *"accurics.azure.NPS.278"* ]]
  [[ "$output" == *"accurics.azure.NPS.279"* ]]
  [[ "$output" == *"accurics.azure.NPS.280"* ]]
  [[ "$output" == *"accurics.azure.NPS.281"* ]]
  [[ "$output" == *"accurics.azure.NPS.282"* ]]
  [[ "$output" == *"accurics.azure.NPS.283"* ]]
  [[ "$output" == *"accurics.azure.NPS.284"* ]]
  [[ "$output" == *"accurics.azure.NPS.285"* ]]
  [[ "$output" == *"accurics.azure.NPS.286"* ]]
  [[ "$output" == *"accurics.azure.NPS.287"* ]]
  [[ "$output" == *"accurics.azure.NPS.288"* ]]
  [[ "$output" == *"accurics.azure.NPS.289"* ]]
  [[ "$output" == *"accurics.azure.NPS.290"* ]]
  [[ "$output" == *"accurics.azure.NPS.291"* ]]
  [[ "$output" == *"accurics.azure.NPS.292"* ]]
  [[ "$output" == *"accurics.azure.NPS.293"* ]]
  [[ "$output" == *"accurics.azure.NPS.294"* ]]
  [[ "$output" == *"accurics.azure.NPS.295"* ]]
  [[ "$output" == *"accurics.azure.NPS.296"* ]]
  [[ "$output" == *"accurics.azure.NPS.297"* ]]
  [[ "$output" == *"accurics.azure.NPS.298"* ]]
  [[ "$output" == *"accurics.azure.NPS.299"* ]]
  [[ "$output" == *"accurics.azure.NPS.300"* ]]
  [[ "$output" == *"accurics.azure.NPS.301"* ]]
  [[ "$output" == *"accurics.azure.NPS.302"* ]]
  [[ "$output" == *"accurics.azure.NPS.303"* ]]
  [[ "$output" == *"accurics.azure.NPS.304"* ]]
  [[ "$output" == *"accurics.azure.NPS.305"* ]]
  [[ "$output" == *"accurics.azure.NPS.306"* ]]
  [[ "$output" == *"accurics.azure.NPS.307"* ]]
  [[ "$output" == *"accurics.azure.NPS.308"* ]]
  [[ "$output" == *"accurics.azure.NPS.309"* ]]
  [[ "$output" == *"accurics.azure.NPS.310"* ]]
  [[ "$output" == *"accurics.azure.NPS.311"* ]]
  [[ "$output" == *"accurics.azure.NPS.312"* ]]
  [[ "$output" == *"accurics.azure.NPS.313"* ]]
  [[ "$output" == *"accurics.azure.NPS.314"* ]]
  [[ "$output" == *"accurics.azure.NPS.315"* ]]
  [[ "$output" == *"accurics.azure.NPS.35"* ]]
  [[ "$output" == *"accurics.azure.NPS.36"* ]]
  [[ "$output" == *"accurics.azure.NPS.37"* ]]
  [[ "$output" == *"accurics.azure.NPS.38"* ]]
  [[ "$output" == *"accurics.azure.NPS.39"* ]]
  [[ "$output" == *"accurics.azure.NPS.40"* ]]
  [[ "$output" == *"accurics.azure.NPS.41"* ]]
  [[ "$output" == *"accurics.azure.NPS.42"* ]]
  [[ "$output" == *"accurics.azure.NPS.43"* ]]
  [[ "$output" == *"accurics.azure.NPS.44"* ]]
  [[ "$output" == *"accurics.azure.NPS.45"* ]]
  [[ "$output" == *"accurics.azure.NPS.46"* ]]
  [[ "$output" == *"accurics.azure.NPS.47"* ]]
  [[ "$output" == *"accurics.azure.NPS.48"* ]]
  [[ "$output" == *"accurics.azure.NPS.49"* ]]
  [[ "$output" == *"accurics.azure.NPS.50"* ]]
  [[ "$output" == *"accurics.azure.NPS.51"* ]]
  [[ "$output" == *"accurics.azure.NPS.52"* ]]
  [[ "$output" == *"accurics.azure.NPS.53"* ]]
  [[ "$output" == *"accurics.azure.NPS.54"* ]]
  [[ "$output" == *"accurics.azure.NPS.55"* ]]
  [[ "$output" == *"accurics.azure.NPS.56"* ]]
  [[ "$output" == *"accurics.azure.NPS.57"* ]]
  [[ "$output" == *"accurics.azure.NPS.58"* ]]
  [[ "$output" == *"accurics.azure.NPS.59"* ]]
  [[ "$output" == *"accurics.azure.NPS.60"* ]]
  [[ "$output" == *"accurics.azure.NPS.61"* ]]
  [[ "$output" == *"accurics.azure.NPS.62"* ]]
  [[ "$output" == *"accurics.azure.NPS.63"* ]]
  [[ "$output" == *"accurics.azure.NPS.64"* ]]
  [[ "$output" == *"accurics.azure.NPS.65"* ]]
  [[ "$output" == *"accurics.azure.NPS.66"* ]]
  [[ "$output" == *"accurics.azure.NPS.67"* ]]
  [[ "$output" == *"accurics.azure.NPS.68"* ]]
  [[ "$output" == *"accurics.azure.NPS.69"* ]]
  [[ "$output" == *"accurics.azure.NPS.70"* ]]
  [[ "$output" == *"accurics.azure.NPS.71"* ]]
  [[ "$output" == *"accurics.azure.NPS.72"* ]]
  [[ "$output" == *"accurics.azure.NPS.73"* ]]
  [[ "$output" == *"accurics.azure.NPS.74"* ]]
  [[ "$output" == *"accurics.azure.NPS.75"* ]]
  [[ "$output" == *"accurics.azure.NPS.76"* ]]
  [[ "$output" == *"accurics.azure.NPS.77"* ]]
  [[ "$output" == *"accurics.azure.NPS.78"* ]]
  [[ "$output" == *"accurics.azure.NPS.79"* ]]
  [[ "$output" == *"accurics.azure.NPS.80"* ]]
  [[ "$output" == *"accurics.azure.NPS.81"* ]]
  [[ "$output" == *"accurics.azure.NPS.82"* ]]
  [[ "$output" == *"accurics.azure.NPS.83"* ]]
  [[ "$output" == *"accurics.azure.NPS.84"* ]]
  [[ "$output" == *"accurics.azure.NPS.85"* ]]
  [[ "$output" == *"accurics.azure.NPS.86"* ]]
  [[ "$output" == *"accurics.azure.NPS.87"* ]]
  [[ "$output" == *"accurics.azure.NPS.88"* ]]
  [[ "$output" == *"accurics.azure.NPS.89"* ]]
  [[ "$output" == *"accurics.azure.NPS.90"* ]]
  [[ "$output" == *"accurics.azure.NPS.91"* ]]
  [[ "$output" == *"accurics.azure.NPS.92"* ]]
  [[ "$output" == *"accurics.azure.NPS.93"* ]]
  [[ "$output" == *"accurics.azure.NPS.94"* ]]
  [[ "$output" == *"accurics.azure.NPS.95"* ]]
  [[ "$output" == *"accurics.azure.NPS.96"* ]]
  [[ "$output" == *"accurics.azure.NPS.97"* ]]
  [[ "$output" == *"accurics.azure.NPS.98"* ]]
  [[ "$output" == *"accurics.azure.NPS.99"* ]]
  [[ "$output" == *"accurics.azure.NS.166"* ]]
  [[ "$output" == *"accurics.azure.NS.169"* ]]
  [[ "$output" == *"accurics.azure.NS.169"* ]]
  [[ "$output" == *"accurics.azure.NS.21"* ]]
  [[ "$output" == *"accurics.azure.NS.272"* ]]
  [[ "$output" == *"accurics.azure.NS.272"* ]]
  [[ "$output" == *"accurics.azure.NS.272"* ]]
  [[ "$output" == *"accurics.azure.NS.272"* ]]
  [[ "$output" == *"accurics.azure.NS.272"* ]]
  [[ "$output" == *"accurics.azure.NS.272"* ]]
  [[ "$output" == *"accurics.azure.NS.272"* ]]
  [[ "$output" == *"accurics.azure.NS.272"* ]]
  [[ "$output" == *"accurics.azure.NS.30"* ]]
  [[ "$output" == *"accurics.azure.NS.31"* ]]
  [[ "$output" == *"accurics.azure.NS.5"* ]]
}
